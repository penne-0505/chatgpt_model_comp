# 結論 / TL;DR

オブジェクトストレージの整合性モデルは、強い整合性・読み取り整合性・最終的整合性に分類され、パフォーマンスと一貫性のトレードオフを用途に応じて選択する。

## 全体像

* **オブジェクトストレージ**

  * データをオブジェクト単位で保存し、分散レプリケーションで可用性を確保。
* **整合性モデル**

  * 書き込み後に読み取りで最新状態を保証する度合いを定義。
* **主なモデル**

  1. 強い整合性（Strong Consistency）
  2. 読み取り整合性（Read-after-write / Session Consistency）
  3. 最終的整合性（Eventual Consistency）
* **トレードオフ**

  * 即時性（最新データ保証） ↔ レイテンシ・スループット

## 詳細

1. 強い整合性

   1. **何をするか**：書き込み完了後、全ノードから最新データを即座に読み取れる。
   2. **なぜ重要か**：金融取引や在庫管理などで、あらゆる読み取りが常に最新情報を要するため。
   3. **どのように行うか**：同期レプリケーションやクワーラム合意、分散トランザクションを利用。

   > **ポイント**: レイテンシや可用性への影響が大きくなるリスクがある。

2. 読み取り整合性（セッション整合性）

   1. **何をするか**：同一クライアントセッション内では自分の書き込みを即時に反映し、それ以外は遅延。
   2. **なぜ重要か**：ユーザー体験を維持しつつ、一貫性要求は緩やかなケースに最適。
   3. **どのように行うか**：セッションID管理とリード-your-write制御を実装。

3. 最終的整合性

   1. **何をするか**：書き込み直後は旧データを返す可能性があるが、最終的に全ノードで一致。
   2. **なぜ重要か**：グローバル分散環境で超低レイテンシ・高スループットを実現するため。
   3. **どのように行うか**：非同期レプリケーションと矛盾検知・修復メカニズムを組み合わせる。

## まとめ

1. **選択基準**：一貫性要求（安全性） vs パフォーマンス（速度・可用性）のバランス。
2. **モデル比較**：

   * 強い整合性：安全性重視、レイテンシ高め
   * 読み取り整合性：ユーザー体験重視、中間的性能
   * 最終的整合性：スケーラビリティ重視、超低レイテンシ
3. **クラウド動向**：主要クラウドサービスは標準で強い整合性を採用しつつあるため、要件に応じて最適モデルを選定する。

| 整合性モード                    | 整合速度     | 事例                                 |
| ------------------------- | -------- | ---------------------------------- |
| 強い整合性（Strong Consistency） | 即時       | Amazon S3（現在）・Google Cloud Storage |
| 読み取り整合性（Session）          | セッション内即時 | Azure Blob Storage                 |
| 最終的整合性（Eventual)          | 数秒～分     | Ceph RADOS・OpenStack Swift         |
